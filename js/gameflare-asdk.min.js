var Gameflare;!function(e){"function"==typeof define&&define.amd?define(["jquery"],(function(t){return e(t)})):"object"==typeof module&&"object"==typeof module.exports?module.exports=e(require("jquery")):e(window.jQuery)}((function(e){"use strict";function t(e){void 0===e&&(e=window.navigator.userAgent),e=e.toLowerCase();var t=/(edge)\/([\w.]+)/.exec(e)||/(opr)[\/]([\w.]+)/.exec(e)||/(chrome)[ \/]([\w.]+)/.exec(e)||/(iemobile)[\/]([\w.]+)/.exec(e)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[],i=/(ipad)/.exec(e)||/(ipod)/.exec(e)||/(windows phone)/.exec(e)||/(iphone)/.exec(e)||/(kindle)/.exec(e)||/(silk)/.exec(e)||/(android)/.exec(e)||/(win)/.exec(e)||/(mac)/.exec(e)||/(linux)/.exec(e)||/(cros)/.exec(e)||/(playbook)/.exec(e)||/(bb)/.exec(e)||/(blackberry)/.exec(e)||[],s={},n={browser:t[5]||t[3]||t[1]||"",version:t[2]||t[4]||"0",versionNumber:t[4]||t[2]||"0",platform:i[0]||""};if(n.browser&&(s[n.browser]=!0,s.version=n.version,s.versionNumber=parseInt(n.versionNumber,10)),n.platform&&(s[n.platform]=!0),(s.android||s.bb||s.blackberry||s.ipad||s.iphone||s.ipod||s.kindle||s.playbook||s.silk||s["windows phone"])&&(s.mobile=!0),(s.cros||s.mac||s.linux||s.win)&&(s.desktop=!0),(s.chrome||s.opr||s.safari)&&(s.webkit=!0),s.rv||s.iemobile){var o="msie";n.browser=o,s[o]=!0}if(s.edge){delete s.edge;var a="msedge";n.browser=a,s[a]=!0}if(s.safari&&s.blackberry){var r="blackberry";n.browser=r,s[r]=!0}if(s.safari&&s.playbook){var h="playbook";n.browser=h,s[h]=!0}if(s.bb){var d="blackberry";n.browser=d,s[d]=!0}if(s.opr){var l="opera";n.browser=l,s[l]=!0}if(s.safari&&s.android){var c="android";n.browser=c,s[c]=!0}if(s.safari&&s.kindle){var f="kindle";n.browser=f,s[f]=!0}if(s.safari&&s.silk){var u="silk";n.browser=u,s[u]=!0}return s.name=n.browser,s.platform=n.platform,s}return window.jQBrowser=t(window.navigator.userAgent),window.jQBrowser.uaMatch=t,e&&(e.browser=window.jQBrowser),window.jQBrowser})),function(e,t){"object"==typeof exports&&"object"==typeof module?(module.exports=t(),module.exports.default=module.exports):"object"==typeof exports?exports.EventBus=t():e.EventBus=t()}(this,(function(){return function(){this.listeners={},this.registerListener=function(t,i,s){var n=t.constructor.name;s=this.validateNumber(s||"any"),"Array"!==n&&(t=[t]),t.forEach((function(t){if("String"!==t.constructor.name)throw new Error("Only `String` and array of `String` are accepted for the event names!");e.listeners[t]=e.listeners[t]||[],e.listeners[t].push({callback:i,number:s})}))},this.validateNumber=function(e){var t=e.constructor.name;if("Number"===t)return e;if("String"===t&&"any"===e.toLowerCase())return"any";throw new Error("Only `Number` and `any` are accepted in the number of possible executions!")},this.toBeRemoved=function(e){var t=e.number;return e.execution=e.execution||0,e.execution++,!("any"===t||e.execution<t)};var e=this;return{on:function(t,i){e.registerListener.bind(e)(t,i,"any")},once:function(t,i){e.registerListener.bind(e)(t,i,1)},exactly:function(t,i,s){e.registerListener.bind(e)(i,s,t)},die:function(t){delete e.listeners[t]},off:function(e){this.die(e)},detach:function(t,i){if(void 0===i)return e.listeners[t]=[],!0;for(var s in e.listeners[t])if(e.listeners[t].hasOwnProperty(s)&&e.listeners[t][s].callback===i)return e.listeners[t].splice(s,1),this.detach(t,i);return!0},detachAll:function(){for(var t in e.listeners)e.listeners.hasOwnProperty(t)&&this.detach(t)},emit:function(t,i){var s=[];for(var n in e.listeners)if(e.listeners.hasOwnProperty(n)&&(n===t&&Array.prototype.push.apply(s,e.listeners[n]),n.indexOf("*")>=0)){var o=n.replace(/\*\*/,"([^.]+.?)+");o=o.replace(/\*/g,"[^.]+");var a=t.match(o);a&&t===a[0]&&Array.prototype.push.apply(s,e.listeners[n])}var r=arguments;i=i||this,s.forEach((function(s,n){var o=s.callback;s.number;i&&(o=o.bind(i));var a=[];Object.keys(r).map((function(e){e>1&&a.push(r[e])})),e.toBeRemoved(s)&&e.listeners[t].splice(n,1),o.apply(null,a)}))}}}})),function(e){var t;if("function"==typeof define&&define.amd&&(define(e),t=!0),"object"==typeof exports&&(module.exports=e(),t=!0),!t){var i=window.Cookies,s=window.Cookies=e();s.noConflict=function(){return window.Cookies=i,s}}}((function(){function e(){for(var e=0,t={};e<arguments.length;e++){var i=arguments[e];for(var s in i)t[s]=i[s]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function i(s){function n(){}function o(t,i,o){if("undefined"!=typeof document){"number"==typeof(o=e({path:"/"},n.defaults,o)).expires&&(o.expires=new Date(1*new Date+864e5*o.expires)),o.expires=o.expires?o.expires.toUTCString():"";try{var a=JSON.stringify(i);/^[\{\[]/.test(a)&&(i=a)}catch(e){}i=s.write?s.write(i,t):encodeURIComponent(String(i)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var r="";for(var h in o)o[h]&&(r+="; "+h,!0!==o[h]&&(r+="="+o[h].split(";")[0]));return document.cookie=t+"="+i+r}}function a(e,i){if("undefined"!=typeof document){for(var n={},o=document.cookie?document.cookie.split("; "):[],a=0;a<o.length;a++){var r=o[a].split("="),h=r.slice(1).join("=");i||'"'!==h.charAt(0)||(h=h.slice(1,-1));try{var d=t(r[0]);if(h=(s.read||s)(h,d)||t(h),i)try{h=JSON.parse(h)}catch(e){}if(n[d]=h,e===d)break}catch(e){}}return e?n[e]:n}}return n.set=o,n.get=function(e){return a(e,!1)},n.getJSON=function(e){return a(e,!0)},n.remove=function(t,i){o(t,"",e(i,{expires:-1}))},n.defaults={},n.withConverter=i,n}((function(){}))})),Array.prototype.filter||(Array.prototype.filter=function(e,t){"use strict";if("Function"!=typeof e&&"function"!=typeof e||!this)throw new TypeError;var i=this.length>>>0,s=new Array(i),n=this,o=0,a=-1;if(void 0===t)for(;++a!==i;)a in this&&e(n[a],a,n)&&(s[o++]=n[a]);else for(;++a!==i;)a in this&&e.call(t,n[a],a,n)&&(s[o++]=n[a]);return s.length=o,s}),Array.prototype.map||(Array.prototype.map=function(e){var t,i,s;if(null==this)throw new TypeError("this is null or not defined");var n=Object(this),o=n.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(arguments.length>1&&(t=arguments[1]),i=new Array(o),s=0;s<o;){var a,r;s in n&&(a=n[s],r=e.call(t,a,s,n),i[s]=r),s++}return i}),((Gameflare=Gameflare||{}).Asdk=Gameflare.Asdk||{}).Miscellaneous={checkReferrer:function(e,t){if(e){var i=e.match(/:\/\/(.[^/]+)/)[1];return void 0===i||-1===$.inArray(i,t)}return!0},gaCode:function(){function e(){dataLayer.push(arguments)}$("<script>").attr("src","//www.googletagmanager.com/gtag/js?id=UA-8443334-23").prop("async",!0).appendTo("head"),window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","UA-8443334-23")},getDomain:function(e){if(e&&(host=e.match(/:\/\/(.[^/]+)/)[1],void 0!==host))return host},adBlockDetected:function(){return!document.getElementById("EzeYXHhUTSNR")},noAdBlock:function(){return!this.adBlockDetected()},isOnMobile:function(){return/Mobi/i.test(window.navigator.userAgent)}},function(e){var t=function(e){this.config=e,this.setConfig(),this.loadGoogleAnalytics(),this.notifyAboutAdBlock(),this.hideFooterInfoInGame()};t.prototype.setConfig=function(){this.config.isEmbed=Gameflare.Asdk.Miscellaneous.checkReferrer(document.referrer,this.config.allowedDomains),this.config.isGame=!this.config.isEmbed,this.config.splashScreen.policy.active=this.config.isEmbed},t.prototype.loadGoogleAnalytics=function(){this.config.isEmbed&&Gameflare.Asdk.Miscellaneous.gaCode()},t.prototype.notifyAboutAdBlock=function(){setTimeout((function(){Gameflare.Asdk.Miscellaneous.adBlockDetected()&&"undefined"!=typeof ga&&ga("send","event","Blocking Ads","yes")}),1e3)},t.prototype.hideFooterInfoInGame=function(){if(this.config.isGame){var e=$(".embed-footer");$(".logo",e).hide(),$(".more .button",e).hide()}},e.Initialization=t}((Gameflare=Gameflare||{}).Asdk=Gameflare.Asdk||{}),((Gameflare=Gameflare||{}).Asdk=Gameflare.Asdk||{}).eventBus=new EventBus,function(e){var t=function(e){this.selector="#gameflare-asdk",this.el=$(this.selector),this.config=e};t.prototype.append=function(e){this.el.append(e)},t.prototype.empty=function(){this.el.empty()},t.prototype.show=function(){this.el.show()},t.prototype.hide=function(){this.el.hide()},t.prototype.setBackgroundColor=function(e){this.el.css("backgroundColor",e)},t.prototype.setTransparentBackground=function(){this.el.css("backgroundColor","transparent")},t.prototype.reset=function(){this.config.advert.network=this.config.advert.originalNetwork,this.config.splashScreen.active=!1,this.config.isPreloadAds=!1,this.empty(),this.show()},e.Canvas=t}((Gameflare=Gameflare||{}).Asdk=Gameflare.Asdk||{}),function(e){var t=function(){this.selector="#game-container",this.el=$(this.selector)};t.prototype.show=function(){this.el.show()},t.prototype.hide=function(){this.el.hide()},e.GameContainer=t}((Gameflare=Gameflare||{}).Asdk=Gameflare.Asdk||{}),function(e){var t=function(e,t){this.config=e,this.eventBus=t};t.prototype.load=function(){this.eventBus.emit("loadGame",null,{isEmbed:this.config.isEmbed,isGame:this.config.isGame})},e.Game=t}((Gameflare=Gameflare||{}).Asdk=Gameflare.Asdk||{}),function(e){var t=function(){this.el=$(".embed-footer"),this.gameObject=$(".game-object")};t.prototype.enable=function(){this.gameObject.addClass("has-footer")},t.prototype.disable=function(){this.gameObject.removeClass("has-footer")},t.prototype.show=function(){this.enable(),this.el.show()},t.prototype.hide=function(){this.disable(),this.el.hide()},e.Footer=t}((Gameflare=Gameflare||{}).Asdk=Gameflare.Asdk||{}),function(e){var t=function(e){this.config=e};t.prototype.check=function(){return this.config.isEmbed&&"without-ads-in-embed"==this.config.advert.type},t.prototype.backup=function(){this.config.advert.network="none",GameflareAsdk.run(this.config)},e.WithoutAds=t}((Gameflare=Gameflare||{}).Asdk=Gameflare.Asdk||{}),function(e){var t=function(e){this.config=e};t.prototype.check=function(){return this.config.isEmbed&&-1!==$.inArray(Gameflare.Asdk.Miscellaneous.getDomain(document.referrer),this.config.blacklist.domains)},e.Blacklist=t}((Gameflare=Gameflare||{}).Asdk=Gameflare.Asdk||{}),function(e){var t=function(e,t,i){this.selector=".game-splash-click",this.el=null,this.gameObject=$(".game-object"),this.config=e,this.canvas=t,this.footer=i};t.prototype.appendTemplate=function(){this.canvas.append(Handlebars.templates["gameflare-asdk/splashScreen"](this.config)),this.setUp(),this.config.isGame&&this.footer.hide()},t.prototype.setUp=function(){this.el=$(this.selector),this.gameObject.addClass("has-splash-screen")},t.prototype.show=function(){this.el.addClass("show"),this.gameObject.addClass("has-splash-screen")},t.prototype.hide=function(){this.el.removeClass("show"),this.gameObject.removeClass("has-splash-screen"),this.config.isGame&&this.footer.show(),this.config.isGame&&this.config.isOnMobile&&this.config.hasMobileSupport&&parent.$(parent.document).trigger("do-fullscreen-on-mobile")},t.prototype.onClick=function(e){$(document).on("click",this.selector,e),$(document).on("click",".external-link",(function(e){e.stopPropagation()}))},e.SplashScreen=t}((Gameflare=Gameflare||{}).Asdk=Gameflare.Asdk||{}),function(e){var t=function(e,t,i,s,n,o){this.selector="#own-images-container",this.skipPreloadSelector=this.selector+" .skip-preload",this.el=null,this.foregroundEl=null,this.bodyEl=null,this.showTimeEl=null,this.overlayEl=null,this.intervalShowTiming=null,this.adsTypes=[{image:"horizontalBig",width:728,height:90},{image:"horizontalSmall",width:468,height:60},{image:"verticalBig",width:300,height:600},{image:"verticalMiddle",width:160,height:600},{image:"verticalSmall",width:120,height:600},{image:"squareBig",width:336,height:280},{image:"squareMiddle",width:300,height:250},{image:"squareSmall",width:200,height:200}],this.isGameRunning=!1,this.isFirstTimeAsShowAds=e.isPreloadAds,this.isEventBusSendingMessage=!1,this.config=e,this.canvas=t,this.gameContainer=i,this.game=s,this.eventBus=n,this.footer=o};t.prototype.appendTemplate=function(){this.canvas.append(Handlebars.templates["gameflare-asdk/ownImages"](this.config)),this.setUp(),this.registerEvents()},t.prototype.playAds=function(){this.eventBus.emit("GAMEFLARE_ASDK_GAME_PAUSE"),this.footer.hide(),this.fadeForeground(),this.show();var e=this.getSelectedAdsType();this.bodyEl.css("maxWidth",e.width+"px"),this.overlayEl.append(Handlebars.templates["gameflare-asdk/iframe"](e)),this.intervalShowTiming=setInterval(this.showTiming.bind(this),1e3)},t.prototype.show=function(){this.el.addClass("show")},t.prototype.hide=function(){this.el.removeClass("show")},t.prototype.setUp=function(){this.el=$(this.selector),this.foregroundEl=$(".foreground",this.el),this.bodyEl=$(".body",this.el),this.showTimeEl=$(".show-time",this.el),this.overlayEl=$(".overlay",this.el)},t.prototype.registerEvents=function(){var e=this;$(document).on("click",this.skipPreloadSelector,(function(t){t.preventDefault(),e.runGame()}))},t.prototype.fadeForeground=function(){this.foregroundEl.delay(500).fadeTo(1500,0,(function(){$(this).hide()}))},t.prototype.getSelectedAdsType=function(){var e=this,t=this.getSize(),i=this.adsTypes.filter((function(i){return e.config.networks.ownImages.exists?i.width<t.width&&i.height<t.height:"squareBig"==i.image})).map((function(t){return{image:t.image,width:t.width,height:t.height,src:e.config.networks.ownImages.url+t.image}}));return i[Math.floor(Math.random()*i.length)]},t.prototype.getSize=function(){return{width:this.overlayEl.attr("data-width")?this.overlayEl.data("width"):$(window).width(),height:this.overlayEl.attr("data-height")?this.overlayEl.data("height"):$(window).height()}},t.prototype.showTiming=function(){var e=parseInt(this.showTimeEl.html())-1;this.showTimeEl.html(e<10?"0"+e:e),0==e&&(clearInterval(this.intervalShowTiming),this.runGame())},t.prototype.runGame=function(){this.isGameRunning&&this.config.isPreloadAds||(this.isGameRunning=!0,this.hide(),this.gameContainer.show(),(this.config.isPreloadAds||this.isFirstTimeAsShowAds)&&(this.game.load(),this.isFirstTimeAsShowAds=!1),clearInterval(this.intervalShowTiming),this.footer.show(),this.canvas.hide(),this.sendRunningGameEvent())},t.prototype.sendRunningGameEvent=function(){var e=this;this.isEventBusSendingMessage||(this.isEventBusSendingMessage=!0,this.eventBus.emit("GAMEFLARE_ASDK_GAME_START")),setTimeout((function(){e.isEventBusSendingMessage=!1}),5e3)},e.OwnImages=t}((Gameflare=Gameflare||{}).Asdk=Gameflare.Asdk||{}),function(e){var t=function(e,t,i,s){this.isGameRunning=!1,this.isFirstTimeAsShowAds=e.isPreloadAds,this.config=e,this.canvas=t,this.gameContainer=i,this.game=s};t.prototype.runGame=function(){if(!this.isGameRunning||!this.config.isPreloadAds){if(this.isGameRunning=!0,this.gameContainer.show(),this.config.isPreloadAds||this.isFirstTimeAsShowAds){var e=this;setTimeout((function(){e.game.load()}),1),this.isFirstTimeAsShowAds=!1}this.canvas.hide()}},e.None=t}((Gameflare=Gameflare||{}).Asdk=Gameflare.Asdk||{}),function(e){var t=function(e,t,i,s,n,o){this.selector="#adsense-container",this.el=null,this.adConfigPromise=null,this.timeoutPromise=null,this.isGameRunning=!1,this.isFirstTimeAsShowAds=e.isPreloadAds,this.isEventBusSendingMessage=!1,this.config=e,this.canvas=t,this.gameContainer=i,this.game=s,this.eventBus=n,this.footer=o};t.prototype.appendTemplate=function(){this.canvas.append(Handlebars.templates["gameflare-asdk/adsense"](this.config.isGame?this.config.networks.adsense.game:this.config.networks.adsense))},t.prototype.playPrerollAds=function(){var e=this;this.isUndefinedGoogle()?this.runWithoutGoogle():this.isDisabledAdsByEU()?this.runWithoutAdsByEU():(this.eventBus.emit("GAMEFLARE_ASDK_GAME_PAUSE"),this.footer.hide(),this.setUp(),this.show(),Promise.race([this.adConfigPromise,this.timeoutPromise]).then((function(t){t?adBreak({type:"preroll",name:"Preroll",adBreakDone:function(t){"viewed"===t.breakStatus?e.runGame("preroll"):e.isDisabledAdsByEU()?e.runWithoutAdsByEU():e.runWithoutGoogle()}}):e.isDisabledAdsByEU()?e.runWithoutAdsByEU():e.runWithoutGoogle()})))},t.prototype.playNextAds=function(){var e=this;this.isUndefinedGoogle()?this.runWithoutGoogle():this.isDisabledAdsByEU()?this.runWithoutAdsByEU():(this.eventBus.emit("GAMEFLARE_ASDK_GAME_PAUSE"),this.footer.disable(),this.setUp(),this.show(),Promise.race([this.adConfigPromise,this.timeoutPromise]).then((function(t){t?adBreak({type:"next",name:"Next",adBreakDone:function(t){"viewed"===t.breakStatus?e.runGame("next"):e.isDisabledAdsByEU()?e.runWithoutAdsByEU():e.runWithoutGoogle()}}):e.isDisabledAdsByEU()?e.runWithoutAdsByEU():e.runWithoutGoogle()})))},t.prototype.playRewardedAds=function(){var e=this;this.isUndefinedGoogle()?this.runWithoutGoogle():this.isDisabledAdsByEU()?this.runWithoutAdsByEU():(this.eventBus.emit("GAMEFLARE_ASDK_GAME_PAUSE"),this.footer.disable(),this.setUp(),this.show(),Promise.race([this.adConfigPromise,this.timeoutPromise]).then((function(t){t?adBreak({type:"reward",name:"Reward",beforeReward:function(e){e()},adDismissed:function(){e.runGame("dismissed")},adViewed:function(){e.runGame("rewarded")}}):e.isDisabledAdsByEU()?e.runWithoutAdsByEU():e.runWithoutGoogle()})))},t.prototype.isUndefinedGoogle=function(){return"undefined"==typeof adsbygoogle},t.prototype.isDisabledAdsByEU=function(){return window.disabledAdsByEU},t.prototype.show=function(){this.el.addClass("show")},t.prototype.hide=function(){this.el.removeClass("show")},t.prototype.remove=function(){this.el.remove()},t.prototype.setUp=function(){this.el=$(this.selector);var e=this;this.adConfigPromise=new Promise((function(t,i){var s={sound:"on",onReady:function(){return t(!0)}};return e.isFirstTimeAsShowAds&&(s.preloadAdBreaks="on"),adConfig(s)})),this.timeoutPromise=new Promise((function(e,t){setTimeout((function(){return e(!1)}),5e3)}))},t.prototype.runGame=function(e){this.isGameRunning&&this.config.isPreloadAds||(this.isGameRunning=!0,this.hide(),this.gameContainer.show(),(this.config.isPreloadAds||this.isFirstTimeAsShowAds)&&(this.game.load(),this.isFirstTimeAsShowAds=!1),this.footer.show(),this.canvas.hide(),this.sendRunningGameEvent(e))},t.prototype.runWithoutGoogle=function(){this.el=$(this.selector),this.backup()},t.prototype.runWithoutAdsByEU=function(){this.el=$(this.selector),this.backupEU()},t.prototype.backup=function(){this.remove(),this.config.advert.network=this.config.isGame?this.config.networks.adsense.game.backup:this.config.networks.adsense.backup,this.config.splashScreen.active=!1,GameflareAsdk.run(this.config)},t.prototype.backupEU=function(){this.remove(),this.config.advert.network=this.config.isGame?this.config.networks.adsense.game.backupEU:this.config.networks.adsense.backupEU,this.config.splashScreen.active=!1,GameflareAsdk.run(this.config)},t.prototype.sendRunningGameEvent=function(e){var t=this;this.isEventBusSendingMessage||(this.isEventBusSendingMessage=!0,this.eventBus.emit("rewarded"===e?"GAMEFLARE_ASDK_REWARDED_WATCH_COMPLETE":"GAMEFLARE_ASDK_GAME_START")),setTimeout((function(){t.isEventBusSendingMessage=!1}),5e3)},e.AdSense=t}((Gameflare=Gameflare||{}).Asdk=Gameflare.Asdk||{}),function(e){var t=function(e,t,i,s,n,o){this.selector="#cpmstar-container",this.skipPreloadSelector=this.selector+" .skip-preload",this.el=null,this.foregroundEl=null,this.bodyEl=null,this.showTimeEl=null,this.overlayEl=null,this.intervalShowTiming=null,this.adsTypes=[{pid:47512,width:125,height:125},{pid:47513,width:300,height:250},{pid:47514,width:728,height:90},{pid:47515,width:200,height:200},{pid:47516,width:468,height:60}],this.isGameRunning=!1,this.isFirstTimeAsShowAds=e.isPreloadAds,this.isEventBusSendingMessage=!1,this.config=e,this.canvas=t,this.gameContainer=i,this.game=s,this.eventBus=n,this.footer=o};t.prototype.appendTemplate=function(){this.canvas.append(Handlebars.templates["gameflare-asdk/cpmstar"](this.config)),this.setUp(),this.registerEvents()},t.prototype.playAds=function(){this.eventBus.emit("GAMEFLARE_ASDK_GAME_PAUSE"),this.footer.hide(),this.fadeForeground(),this.show();var e=this.getSelectedAdsType();this.bodyEl.css("maxWidth",e.width+"px"),this.overlayEl.append(Handlebars.templates["gameflare-asdk/iframe"](e)),this.intervalShowTiming=setInterval(this.showTiming.bind(this),1e3)},t.prototype.show=function(){this.el.addClass("show")},t.prototype.hide=function(){this.el.removeClass("show")},t.prototype.setUp=function(){this.el=$(this.selector),this.foregroundEl=$(".foreground",this.el),this.bodyEl=$(".body",this.el),this.showTimeEl=$(".show-time",this.el),this.overlayEl=$(".overlay",this.el)},t.prototype.registerEvents=function(){var e=this;$(document).on("click",this.skipPreloadSelector,(function(t){t.preventDefault(),e.runGame()}))},t.prototype.fadeForeground=function(){this.foregroundEl.delay(500).fadeTo(1500,0,(function(){$(this).hide()}))},t.prototype.getSelectedAdsType=function(){var e=this,t=this.getSize(),i=this.adsTypes.filter((function(e){return e.width<t.width&&e.height<t.height})).map((function(t){return{pid:t.pid,width:t.width,height:t.height,src:e.config.networks.cpmstar.url+t.pid+(e.config.networks.cpmstar.subpid?"&subpid="+e.config.networks.cpmstar.subpid:"")}}));return i[Math.floor(Math.random()*i.length)]},t.prototype.getSize=function(){return{width:this.overlayEl.attr("data-width")?this.overlayEl.data("width"):$(window).width(),height:this.overlayEl.attr("data-height")?this.overlayEl.data("height"):$(window).height()}},t.prototype.showTiming=function(){var e=parseInt(this.showTimeEl.html())-1;this.showTimeEl.html(e<10?"0"+e:e),0==e&&(clearInterval(this.intervalShowTiming),this.runGame())},t.prototype.runGame=function(){this.isGameRunning&&this.config.isPreloadAds||(this.isGameRunning=!0,this.hide(),this.gameContainer.show(),(this.config.isPreloadAds||this.isFirstTimeAsShowAds)&&(this.game.load(),this.isFirstTimeAsShowAds=!1),clearInterval(this.intervalShowTiming),this.footer.show(),this.canvas.hide(),this.sendRunningGameEvent())},t.prototype.sendRunningGameEvent=function(){var e=this;this.isEventBusSendingMessage||(this.isEventBusSendingMessage=!0,this.eventBus.emit("GAMEFLARE_ASDK_GAME_START")),setTimeout((function(){e.isEventBusSendingMessage=!1}),5e3)},e.CpmStar=t}((Gameflare=Gameflare||{}).Asdk=Gameflare.Asdk||{}),function(e){var t=function(e,t,i,s,n){this.isGameRunning=!1,this.isFirstTimeAsShowAds=e.isPreloadAds,this.isEventBusSendingMessage=!1,this.config=e,this.canvas=t,this.game=i,this.eventBus=s,this.footer=n};t.prototype.appendTemplate=function(e){this.canvas.append(Handlebars.templates["gameflare-asdk/wgplayer"](e))},t.prototype.playAds=function(){var e=this;this.config.isEmbed?$.ajax({url:this.config.networks.wgplayer.url,data:{domain:Gameflare.Asdk.Miscellaneous.getDomain(document.referrer)},timeout:5e3}).done((function(t){t.id!=e.config.networks.wgplayer.domain.id?(e.config.networks.wgplayer.domain.id=t.id,e.appendTemplate(e.config),e.registerEvents(),e.canvas.hide(),e.eventBus.emit("GAMEFLARE_ASDK_GAME_PAUSE"),e.footer.disable(),e.setBranding(t),console.log("Ads for partners")):e.backup()})).fail((function(){e.backup()})):"001"!=this.config.networks.wgplayer.game.id?(this.appendTemplate(this.config),this.registerEvents(),this.canvas.hide(),this.eventBus.emit("GAMEFLARE_ASDK_GAME_PAUSE"),this.footer.disable(),console.log("Ads for partners")):this.backup()},t.prototype.backup=function(){this.config.advert.network=this.config.networks.wgplayer.backup,this.config.splashScreen.active=!0,GameflareAsdk.run(this.config)},t.prototype.setBranding=function(e){e.hasBranding&&e.image&&$(".embed-footer .logo img.branding").attr("src",e.image)},t.prototype.registerEvents=function(){var e=this;setTimeout((function(){e.canRegisterEvents()&&window[preroll.config.loaderObjectName].fetchAd((function(){e.runGame()}))}),4e3)},t.prototype.canRegisterEvents=function(){return"undefined"!=typeof preroll&&void 0!==window[preroll.config.loaderObjectName]},t.prototype.runGame=function(){this.isGameRunning&&this.config.isPreloadAds||(this.isGameRunning=!0,(this.config.isPreloadAds||this.isFirstTimeAsShowAds)&&(this.game.load(),this.isFirstTimeAsShowAds=!1),this.footer.enable(),this.sendRunningGameEvent())},t.prototype.sendRunningGameEvent=function(){var e=this;this.isEventBusSendingMessage||(this.isEventBusSendingMessage=!0,this.eventBus.emit("GAMEFLARE_ASDK_GAME_START")),setTimeout((function(){e.isEventBusSendingMessage=!1}),5e3)},e.WgPlayer=t}((Gameflare=Gameflare||{}).Asdk=Gameflare.Asdk||{}),function(e){var t=function(e,t,i,s,n,o){this.selector="#adsense-ima-container",this.el=null,this.loadingEl=null,this.overlayEl=null,this.adDisplayContainer=null,this.adsLoader=null,this.adsManager=null,this.isGameRunning=!1,this.isFirstTimeAsShowAds=e.isPreloadAds,this.isEventBusSendingMessage=!1,this.config=e,this.canvas=t,this.gameContainer=i,this.game=s,this.eventBus=n,this.footer=o};t.prototype.appendTemplate=function(){this.canvas.append(Handlebars.templates["gameflare-asdk/adsense"](this.config))},t.prototype.playAds=function(){this.isUndefinedGoogle()?this.runWithoutGoogle():this.isDisabledAdsByEU()?this.runWithoutAdsByEU():(this.eventBus.emit("GAMEFLARE_ASDK_GAME_PAUSE"),this.footer.disable(),this.setUp(),this.registerEvents(),this.show(),this.adDisplayContainer.initialize())},t.prototype.isUndefinedGoogle=function(){return"undefined"==typeof google},t.prototype.isDisabledAdsByEU=function(){return window.disabledAdsByEU},t.prototype.show=function(){this.el.addClass("show")},t.prototype.hide=function(){this.el.removeClass("show")},t.prototype.remove=function(){this.el.remove()},t.prototype.setUp=function(){this.el=$(this.selector),this.loadingEl=$(".loading",this.el),this.overlayEl=$("#adsense-overlay",this.el),this.adDisplayContainer=new google.ima.AdDisplayContainer(this.overlayEl[0]),this.adsLoader=new google.ima.AdsLoader(this.adDisplayContainer),this.adsLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,this.onAdsManagerLoaded,!1,this),this.adsLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this.onAdError,!1,this),this.requestAds(this.config.isGame?this.config.networks.adsenseIma.game.tagUrl:this.config.networks.adsenseIma.tagUrl)},t.prototype.registerEvents=function(){var e=this;$(window).on("resize",(function(){e.resize()})),$(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",(function(){e.resize()}))},t.prototype.requestAds=function(e){var t=new google.ima.AdsRequest;t.adTagUrl=e,t.forceNonLinearFullSlot=!0,t.linearAdSlotWidth=this.config.size.width,t.linearAdSlotHeight=this.config.size.height,t.nonLinearAdSlotWidth=this.config.size.width,t.nonLinearAdSlotHeight=this.config.size.height,this.adsLoader.requestAds(t)},t.prototype.getSize=function(){return{width:this.overlayEl.width(),height:this.overlayEl.height()}},t.prototype.resize=function(){if(this.adsManager&&!this.isGameRunning){var e=this.getSize();this.adsManager.resize(e.width,e.height,google.ima.ViewMode.FULLSCREEN)}},t.prototype.runGame=function(){this.isGameRunning&&this.config.isPreloadAds||(this.isGameRunning=!0,this.hide(),this.gameContainer.show(),(this.config.isPreloadAds||this.isFirstTimeAsShowAds)&&(this.game.load(),this.isFirstTimeAsShowAds=!1),this.footer.enable(),this.canvas.hide(),this.sendRunningGameEvent())},t.prototype.runWithoutGoogle=function(){this.el=$(this.selector),this.backup()},t.prototype.runWithoutAdsByEU=function(){this.el=$(this.selector),this.backupEU()},t.prototype.backup=function(){this.remove(),this.config.advert.network=this.config.isGame?this.config.networks.adsenseIma.game.backup:this.config.networks.adsenseIma.backup,this.config.splashScreen.active=!1,GameflareAsdk.run(this.config)},t.prototype.backupEU=function(){this.remove(),this.config.advert.network=this.config.isGame?this.config.networks.adsenseIma.game.backupEU:this.config.networks.adsenseIma.backupEU,this.config.splashScreen.active=!1,GameflareAsdk.run(this.config)},t.prototype.onAdsManagerLoaded=function(e){var t=new google.ima.AdsRenderingSettings;t.restoreCustomPlaybackStateOnAdBreakComplete=!0,this.adsManager=e.getAdsManager(this.adDisplayContainer,t),this.adsManager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this.onAdError,!1,this);var i=[google.ima.AdEvent.Type.LOADED,google.ima.AdEvent.Type.STARTED,google.ima.AdEvent.Type.SKIPPED,google.ima.AdEvent.Type.COMPLETE,google.ima.AdEvent.Type.USER_CLOSE,google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,google.ima.AdEvent.Type.ALL_ADS_COMPLETED];for(var s in i)this.adsManager.addEventListener(i[s],this.onAdEvent,!1,this);try{var n=this.getSize();this.adsManager.init(n.width,n.height,google.ima.ViewMode.NORMAL),this.adsManager.start()}catch(e){this.backup()}},t.prototype.onAdEvent=function(e){switch(e.type){case google.ima.AdEvent.Type.LOADED:this.loadingEl.hide();break;case google.ima.AdEvent.Type.USER_CLOSE:case google.ima.AdEvent.Type.SKIPPED:case google.ima.AdEvent.Type.COMPLETE:case google.ima.AdEvent.Type.ALL_ADS_COMPLETED:case google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED:this.runGame()}},t.prototype.onAdError=function(e){var t=e.getError();t.getErrorCode()===google.ima.AdError.ErrorCode.VAST_EMPTY_RESPONSE||t.getErrorCode()===google.ima.AdError.ErrorCode.VAST_NO_ADS_AFTER_WRAPPER?this.backup():this.runGame(),this.adsManager&&this.adsManager.destroy()},t.prototype.sendRunningGameEvent=function(){var e=this;this.isEventBusSendingMessage||(this.isEventBusSendingMessage=!0,this.eventBus.emit("GAMEFLARE_ASDK_GAME_START")),setTimeout((function(){e.isEventBusSendingMessage=!1}),5e3)},e.AdSenseIma=t}((Gameflare=Gameflare||{}).Asdk=Gameflare.Asdk||{});var GameflareAsdk=function(){};GameflareAsdk.run=function(e){this.config=e,this.config.isOnMobile=Gameflare.Asdk.Miscellaneous.isOnMobile(),this.initialization=new Gameflare.Asdk.Initialization(this.config),this.canvas=new Gameflare.Asdk.Canvas(this.config),this.gameContainer=new Gameflare.Asdk.GameContainer,this.game=new Gameflare.Asdk.Game(this.config,Gameflare.Asdk.eventBus),this.footer=new Gameflare.Asdk.Footer,this.withoutAds=new Gameflare.Asdk.WithoutAds(this.config),this.blacklist=new Gameflare.Asdk.Blacklist(this.config),this.splashScreen=new Gameflare.Asdk.SplashScreen(this.config,this.canvas,this.footer),this.ownImages=new Gameflare.Asdk.OwnImages(this.config,this.canvas,this.gameContainer,this.game,Gameflare.Asdk.eventBus,this.footer),this.none=new Gameflare.Asdk.None(this.config,this.canvas,this.gameContainer,this.game),this.adSense=new Gameflare.Asdk.AdSense(this.config,this.canvas,this.gameContainer,this.game,Gameflare.Asdk.eventBus,this.footer),this.cpmStar=new Gameflare.Asdk.CpmStar(this.config,this.canvas,this.gameContainer,this.game,Gameflare.Asdk.eventBus,this.footer),this.wgPlayer=new Gameflare.Asdk.WgPlayer(this.config,this.canvas,this.game,Gameflare.Asdk.eventBus,this.footer),this.adSenseIma=new Gameflare.Asdk.AdSenseIma(this.config,this.canvas,this.gameContainer,this.game,Gameflare.Asdk.eventBus,this.footer);var t=this;if(("own-images"==this.config.advert.network||Gameflare.Asdk.Miscellaneous.adBlockDetected()||this.blacklist.check())&&"none"!=this.config.advert.network){if(Gameflare.Asdk.Miscellaneous.noAdBlock()&&this.withoutAds.check())return this.withoutAds.backup();this.gameContainer.hide(),this.ownImages.appendTemplate(),this.config.splashScreen.active?(this.splashScreen.appendTemplate(),this.splashScreen.onClick((function(){t.splashScreen.hide(),t.ownImages.playAds()}))):this.ownImages.playAds()}else if("none"==this.config.advert.network)this.config.splashScreen.active?(this.splashScreen.appendTemplate(),this.gameContainer.hide(),this.splashScreen.onClick((function(){t.splashScreen.hide(),t.none.runGame()}))):this.none.runGame();else if("adsense"==this.config.advert.network){if(this.withoutAds.check())return this.withoutAds.backup();this.gameContainer.hide(),this.adSense.appendTemplate(),this.splashScreen.appendTemplate(),this.splashScreen.onClick((function(){t.splashScreen.hide(),t.adSense.playPrerollAds()}))}else if("cpmstar"==this.config.advert.network){if(this.withoutAds.check())return this.withoutAds.backup();this.gameContainer.hide(),this.cpmStar.appendTemplate(),this.config.splashScreen.active?(this.splashScreen.appendTemplate(),this.splashScreen.onClick((function(){t.splashScreen.hide(),t.cpmStar.playAds()}))):this.cpmStar.playAds()}else if("wgplayer"==this.config.advert.network){if(this.withoutAds.check())return this.withoutAds.backup();this.wgPlayer.playAds()}else if("adsense-ima"==this.config.advert.network){if(this.withoutAds.check())return this.withoutAds.backup();this.gameContainer.hide(),this.adSenseIma.appendTemplate(),this.splashScreen.appendTemplate(),this.splashScreen.onClick((function(){t.splashScreen.hide(),t.adSenseIma.playAds()}))}},GameflareAsdk.showAds=function(){if(!Cookies.get(this.config.cookie.key)){if(Cookies.set(this.config.cookie.key,!0,{expires:1/288,sameSite:this.config.cookie.sameSite,secure:this.config.cookie.secure,domain:this.config.cookie.domain}),this.canvas.reset(),("own-images"==this.config.advert.network||Gameflare.Asdk.Miscellaneous.adBlockDetected()||this.blacklist.check())&&"none"!=this.config.advert.network){if(Gameflare.Asdk.Miscellaneous.noAdBlock()&&this.withoutAds.check())return this.withoutAds.backup();this.ownImages.appendTemplate(),this.ownImages.playAds()}else if("none"==this.config.advert.network)this.none.runGame();else if("adsense"==this.config.advert.network){if(this.withoutAds.check())return this.withoutAds.backup();this.adSense.appendTemplate(),this.adSense.playNextAds()}else if("cpmstar"==this.config.advert.network){if(this.withoutAds.check())return this.withoutAds.backup();this.cpmStar.appendTemplate(),this.cpmStar.playAds()}else if("wgplayer"==this.config.advert.network){if(this.withoutAds.check())return this.withoutAds.backup();this.wgPlayer.playAds()}else if("adsense-ima"==this.config.advert.network){if(this.withoutAds.check())return this.withoutAds.backup();this.adSenseIma.appendTemplate(),this.adSenseIma.playAds()}return!0}return!1},GameflareAsdk.showRewardedAds=function(){if(this.canvas.reset(),("own-images"==this.config.advert.network||Gameflare.Asdk.Miscellaneous.adBlockDetected()||this.blacklist.check())&&"none"!=this.config.advert.network){if(Gameflare.Asdk.Miscellaneous.noAdBlock()&&this.withoutAds.check())return this.withoutAds.backup();this.ownImages.appendTemplate(),this.ownImages.playAds()}else if("none"==this.config.advert.network)this.none.runGame();else if("adsense"==this.config.advert.network){if(this.withoutAds.check())return this.withoutAds.backup();this.adSense.appendTemplate(),this.adSense.playRewardedAds()}else if("cpmstar"==this.config.advert.network){if(this.withoutAds.check())return this.withoutAds.backup();this.cpmStar.appendTemplate(),this.cpmStar.playAds()}else if("wgplayer"==this.config.advert.network){if(this.withoutAds.check())return this.withoutAds.backup();this.wgPlayer.playAds()}else if("adsense-ima"==this.config.advert.network){if(this.withoutAds.check())return this.withoutAds.backup();this.adSenseIma.appendTemplate(),this.adSenseIma.playAds()}return!0},GameflareAsdk.loadGame=function(e){this.onEvent("loadGame",e)},GameflareAsdk.onEvent=function(e,t){Gameflare.Asdk.eventBus.on(e,t)};
